<!-- BEGIN pos -->
<!-- <div class="search-container">
	<div class="input-group">
		<i class="bi bi-search"></i>
		<input type="text" placeholder="Search or ask a question">
		<i class="bi bi-mic"></i>
	</div>
	<button class="btn border-0" *ngIf="listType() == 'long'"  (click)="listType.set('list')">
		<i class="bi bi-view-list"></i>
	</button>
	<button class="btn border-0" *ngIf="listType() == 'list'"  (click)="listType.set('long')">
		<i class="bi bi-view-stacked"></i>
	</button>
</div> -->
<app-loader [isLoading]="isLoading"></app-loader>



<card class="pos" id="pos" [ngClass]="{ 'pos-mobile-sidebar-toggled': mobileSidebarToggled }">
	<card-body class="pos-container d-lg-flex">
		<!-- BEGIN pos-content -->
		<div class="pos-content">
			<ng-scrollbar>
				<div class="pos-content-container h-100 p-4">
					<div class="row gx-4" 
						infinite-scroll
						[infiniteScrollDistance]="4"
						[infiniteScrollThrottle]="1000"
						(scrolled)="onScrollDown()"
					>
						@for (item of data; track $index) {
							<div class="col-xxl-3 col-xl-4 col-lg-6 col-md-4 col-sm-6 pb-4">
								<!-- BEGIN card -->
								<div class="flip-card" [class.expanded]="isFlipped($index)" [attr.data-card-index]="$index">
									<div class="flip-card-inner" [class.flipped]="isFlipped($index)">
										<!-- Front Side -->
										<div class="flip-card-front">
											@if (item.images && item.images.length > 0) {
												<img [src]="item.images[0]" [alt]="item.breed.name">
											}
											<div class="overlay-content">
												<div class="text-content">
													<h3 class="pet-name">{{ item.name }}</h3>
													@if (isLoggedIn()) {
														<p class="price">{{ item.price | currency:'INR'}}</p>
													} @else {
														<p class="price locked">â‚¹ XXXXX</p>
													}
												</div>
												<div class="action-icons">
													<button class="icon-btn" *ngIf="isLoggedIn()" >
														<i class="bi bi-heart"></i>
													</button>
													<button class="icon-btn" (click)="toggleFlip($index)">
														<i class="bi bi-info-circle"></i>
													</button>
												</div>
											</div>
										</div>

										<!-- Back Side -->
										<div class="flip-card-back">
											<div class="back-content">
												<div class="header">
													@if (item.images) {
														<ngb-carousel>
															<ng-template ngbSlide *ngFor="let image of item.images">
																<div class="picsum-img-wrapper">
																	<img [src]="image" [alt]="item.breed.name" />
																</div>
															</ng-template>
														</ngb-carousel>
													}
												</div>
												<h3>{{ item.name }}</h3>
												
												<div class="details">
													<p><strong>Breed:</strong> {{ item.breed.name }}</p>
													<p><strong>Age:</strong> {{ item.age }}</p>
													<p><strong>Gender:</strong> {{ item.gender }}</p>
													<p><strong>Price:</strong> 
														@if (isLoggedIn()) {
															{{ item.price | currency:'INR'}}
														} @else {
															<span class="locked">Login to see price</span>
														}
													</p>
												</div>

												@if (isLoggedIn()) {
													<button class="whatsapp-btn" (click)="openWhatsApp(item.listedBy.phone, 
														'Hello '+item.listedBy.name+', I am interested in buying the '+item.name+ 
														' with the following details: \n Breed: '+item.breed.name+', \n Age: '+item.age+
														', \n Could you provide more details about availability and pricing?')">
														<i class="bi bi-whatsapp"></i> Contact Seller
													</button>
												} @else {
													<button class="login-btn" [routerLink]="['/login']">
														<i class="bi bi-box-arrow-in-right"></i> Login to see price
													</button>
												}

												<button class="back-btn" (click)="toggleFlip($index)">
													<i class="bi bi-arrow-left"></i> Back
												</button>
											</div>
										</div>
									</div>
								</div>
								<!-- <card class="h-100">
									<card-body class="h-100 p-1">
									</card-body>
								</card> -->
								<!-- END card -->
							</div>
						} @empty {
							<div class="col-12">
								<div class="text-center">No data found</div>
							</div>
						}

						<div class="text-center" *ngIf="loadingMore()">
							<div class="spinner-border text-theme" role="status">
								<span class="visually-hidden">Loading...</span>
							</div>
						</div>

						<div infinite-scroll-placeholder>
							<button class="btn btn-outline-theme w-100" (click)="onScrollDown()" *ngIf="totalPages > params.page && !loadingMore()">Load more</button>
						</div>
					</div>
				</div>
			</ng-scrollbar>
		</div>
		<!-- END pos-content -->
		</card-body>
		
</card>
<!-- END pos -->

<!-- BEGIN pos-mobile-sidebar-toggler -->
<!-- <a href="javascript:;" class="pos-mobile-sidebar-toggler" (click)="toggleMobileSidebar()">
	<i class="bi bi-bag"></i>
	<span class="badge">{{ getOrderTotal() }}</span>
</a> -->
<!-- END pos-mobile-sidebar-toggler -->

<dialog id="dialog_confirm">
	<div class="dialog">
    <h2>Tips for a safe deal</h2>
    <ul>
        <li>Be safe, take necessary precautions while meeting with buyers and sellers</li>
        <li>Do not enter UPI PIN while receiving money</li>
        <li>Never give money or product in advance</li>
        <li>Report suspicious users to {{brandName}}</li>
    </ul>
    <button type="button" data-bs-dismiss="dialog" (click)="toggleDialogConfirm()">CONTINUE TO OFFER</button>
	</div>
</dialog>

<!-- <app-filter-bottom-sheet [isOpen]="isBottomSheetOpen" (onClose)="isBottomSheetOpen = false"></app-filter-bottom-sheet> -->
